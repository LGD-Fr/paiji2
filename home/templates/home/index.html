{% extends "home/base.html" %}
{% load staticfiles %}
{% load newsfeed %}
{% load readmore %}

{% block title%}Home{% endblock %}

{% block style %}
<link rel="stylesheet" type="text/css" href="{% static 'home/css/index.css' %}" />
{% endblock %}


{% block content %}
{% load cache %}
{% cache 60 index page_obj.number %}
<div class="row">
	<div class="col-md-8">
        <h3>NewsFeed
        	<span class="newsfeed-action">
		        {% if request.user.is_authenticated %}
		        <a href="{% url 'newsfeed-add' %}"><i class="fa fa-plus"></i></a>

		        <a href="{% url 'feed-latest' %}"><i class="fa fa-rss"></i></a>
		        {% endif %}
			</span>
		</h3>
    </div>
    <div class="col-md-4 pagination-container">
    	<ul class="pagination pagination-sm pull-right">
			<li{% if not page_obj.has_previous %} class="disabled"{% endif %}>
			{% if page_obj.has_previous %}
			<a href="{% url 'index' page=page_obj.previous_page_number %}">
				{% else %}
				<a href="#">
					{% endif %}
					&laquo;
				</a>
			</li>
			<li class="disabled"><a href="#">...</a></li>
			<li class="active"><a href="#">{{ page_obj.number }}</a></li>
			<li class="disabled"><a href="#">...</a></li>
			<li{% if not page_obj.has_next %} class="disabled"{% endif %}>
			{% if page_obj.has_next %}
			<a href="{% url 'index' page=page_obj.next_page_number %}">
				{% else %}
				<a href="#">
					{% endif %}
					&raquo;
				</a>
			</li>
		</ul>
	</div>
</div>


{% for item in news %}
<div class="well">
    <div class="row">
        <div class="col-sm-2"><img class="author-icon" src="{{ item.group.logo.url }}"></div>
        <div class="col-sm-10">
            <h4 class="message-title">{{ item.title }}</h4>
            {% if item.author == request.user %}
            	<span class="pull-right">
                <a href="{% url 'newsfeed-edit' item.id %}"><i class="fa fa-pencil"></i></a>
                <a href="{% url 'newsfeed-delete' item.id %}"><i class="fa fa-trash-o"></i></a></span>
        	{% endif %}
            <p class="text-muted"><a href="mailto:{{ item.author.email }}?subject={{ '[Paiji2] Concernant "'|add:item.title|add:'"'|urlencode }}"><i class="glyphicon glyphicon-envelope"></i> {{ item.author.first_name }} </a> pour {{ item.group }}, il y a {{ item.pubDate|timesince }}</p>
        </div>
    </div>
    <div class="news-content">
        {{ item.content|readmore:200|safe }}
    </div>
</div>
{% endfor %}

{% endcache %}
{% endblock %}

{% block js %}

{% endblock %}
